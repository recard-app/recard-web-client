@use 'sass:color';
@use '../../styling/variables' as *;

// Help layout - Desktop
.help-layout {
  display: grid;
  grid-template-columns: 240px 1fr;
  grid-template-areas:
    "sidebar content";
  gap: $space-6;

  &__mobile-toggle {
    display: none !important;
    grid-area: toggle;
  }

  &__sidebar {
    grid-area: sidebar;
    position: sticky;
    top: $space-4;
    align-self: start;
  }

  &__content {
    grid-area: content;
    min-width: 0;
  }

  // Mobile layout
  @media (max-width: $mobile-breakpoint) {
    grid-template-columns: 1fr;
    grid-template-areas:
      "toggle"
      "sidebar"
      "content";
    gap: $space-2;

    &__mobile-toggle {
      display: flex !important;
    }

    &__sidebar {
      position: static;
      display: none;

      &--open {
        display: block;
      }
    }
  }
}

// Override global button styles for help mobile toggle
button.help-layout__mobile-toggle {
  // Reset inherited button styles then rebuild with flexbox
  all: unset !important;
  box-sizing: border-box !important;
  // Hidden on desktop
  display: none !important;
  flex-direction: row !important;
  align-items: center !important;
  justify-content: flex-start !important;
  width: 100% !important;
  gap: $space-2 !important;
  padding: $space-3 $space-4 !important;
  background: $neutral-light-gray !important;
  background-color: $neutral-light-gray !important;
  border: $border-full solid $neutral-gray !important;
  border-radius: $radius-lg !important;
  font-family: $font-inter !important;
  font-size: $font-sm !important;
  font-weight: $font-medium !important;
  color: $neutral-dark-gray !important;
  cursor: pointer !important;
  transition: background-color $transition-fast !important;

  // Ensure icon children don't shrink
  > svg {
    flex-shrink: 0 !important;
  }

  // Show on mobile with flexbox layout
  @media (max-width: $mobile-breakpoint) {
    display: flex !important;
  }

  &:hover,
  &:hover:not(:disabled) {
    background: $neutral-lightest-gray !important;
    background-color: $neutral-lightest-gray !important;
    color: $neutral-dark-gray !important;
    transform: none !important;
  }

  &:focus,
  &:active,
  &:active:not(:disabled) {
    background: $neutral-lightest-gray !important;
    background-color: $neutral-lightest-gray !important;
    color: $neutral-dark-gray !important;
    outline: none !important;
    transform: none !important;
  }
}

.help-layout__mobile-toggle-chevron {
  margin-left: auto;
  transition: transform $transition-fast;

  &--expanded {
    transform: rotate(180deg);
  }
}

// Help sidebar navigation
.help-sidebar {
  display: flex;
  flex-direction: column;
  gap: $space-1;
  padding: $space-2;
  background: $neutral-white;
  border: $border-full solid $neutral-gray;
  border-radius: $radius-lg;
  box-shadow: $shadow-sm;
}

// Help navigation section (collapsible)
// Override global button styles for help nav section header
button.help-nav-section__header {
  // Reset all inherited/global button styles
  all: unset !important;
  box-sizing: border-box !important;
  display: flex !important;
  align-items: center !important;
  width: 100% !important;
  padding: $space-2 $space-3 !important;
  background: transparent !important;
  background-color: transparent !important;
  border: none !important;
  border-radius: $radius-base !important;
  font-family: $font-inter !important;
  font-size: $font-xs !important;
  font-weight: $font-semibold !important;
  color: $neutral-dark-gray !important;
  text-transform: uppercase !important;
  letter-spacing: 0.5px !important;
  cursor: pointer !important;
  transition: background-color $transition-fast !important;

  &:hover,
  &:hover:not(:disabled) {
    background: $neutral-lightest-gray !important;
    background-color: $neutral-lightest-gray !important;
    color: $neutral-dark-gray !important;
    transform: none !important;
  }

  &:focus,
  &:active,
  &:active:not(:disabled) {
    background: $neutral-lightest-gray !important;
    background-color: $neutral-lightest-gray !important;
    color: $neutral-dark-gray !important;
    outline: none !important;
    transform: none !important;
  }

  &:focus-visible {
    outline: 2px solid $neutral-medium-gray !important;
    outline-offset: -2px !important;
  }
}

.help-nav-section {

  &__title {
    flex: 1;
    text-align: left;
  }

  &__chevron {
    transition: transform $transition-fast;

    &--expanded {
      transform: rotate(180deg);
    }
  }

  &__content {
    display: grid;
    transition: grid-template-rows $transition-base;
    grid-template-rows: 1fr;

    &--collapsed {
      grid-template-rows: 0fr;
    }
  }

  &__content-inner {
    min-height: 0;
    overflow: hidden;
  }

  &__content-padding {
    display: flex;
    flex-direction: column;
    gap: $space-half;
    padding-left: $space-2;
    padding-top: $space-1;
    padding-bottom: $space-1;
  }
}

// Help navigation item (link)
.help-nav-item {
  display: block;
  padding: $space-2 $space-3;
  font-family: $font-inter;
  font-size: $font-sm;
  font-weight: $font-regular;
  color: $neutral-dark-gray;
  text-decoration: none;
  border-radius: $radius-base;
  transition: background-color $transition-fast, color $transition-fast;
  outline: none;

  &:hover {
    background: $neutral-lightest-gray;
    color: $neutral-black;
  }

  &:focus,
  &:active {
    background: $neutral-lightest-gray;
    color: $neutral-black;
    outline: none;
  }

  &:focus-visible {
    outline: 2px solid $neutral-medium-gray;
    outline-offset: -2px;
  }

  &--active {
    background: $neutral-light-gray;
    color: $neutral-black;
    font-weight: $font-medium;
  }

  &--indent {
    padding-left: $space-4;
    font-size: $font-xs;
  }
}

// Help content section (expandable)
.help-section {
  margin-bottom: $space-4;
  border: $border-full solid $neutral-gray;
  border-radius: $radius-lg;
  background: $neutral-white;
  overflow: hidden;

  @media (max-width: $mobile-breakpoint) {
    margin-bottom: $space-3;
    border-radius: $radius-base;
  }
}

// Override global button styles for help section header
button.help-section__header {
  // Reset all inherited/global button styles
  all: unset !important;
  box-sizing: border-box !important;
  display: flex !important;
  align-items: center !important;
  width: 100% !important;
  padding: $space-4 !important;
  background: $neutral-light-gray !important;
  background-color: $neutral-light-gray !important;
  border: none !important;
  border-bottom: $border-full solid $neutral-gray !important;
  cursor: pointer !important;
  transition: background-color $transition-fast !important;

  @media (max-width: $mobile-breakpoint) {
    padding: $space-3 !important;
  }

  &:hover,
  &:hover:not(:disabled) {
    background: $neutral-lightest-gray !important;
    background-color: $neutral-lightest-gray !important;
    color: $neutral-black !important;
    transform: none !important;
  }

  &:focus,
  &:active,
  &:active:not(:disabled) {
    background: $neutral-lightest-gray !important;
    background-color: $neutral-lightest-gray !important;
    color: $neutral-black !important;
    outline: none !important;
    transform: none !important;
  }

  &:focus-visible {
    outline: 2px solid $neutral-medium-gray !important;
    outline-offset: -2px !important;
  }
}

.help-section__title {
  flex: 1;
  text-align: left;
  font-family: $font-cal-sans;
  font-size: $font-base;
  color: $neutral-black;
  margin: 0 !important;

  @media (max-width: $mobile-breakpoint) {
    font-size: $font-sm;
  }
}

.help-section__chevron {
  transition: transform $transition-fast;
  flex-shrink: 0;

  &--expanded {
    transform: rotate(180deg);
  }
}

.help-section__content {
  display: grid;
  transition: grid-template-rows $transition-base;
  grid-template-rows: 1fr;

  &--collapsed {
    grid-template-rows: 0fr;
  }
}

.help-section__content-inner {
  min-height: 0;
  overflow: hidden;
}

.help-section__content-padding {
  padding: $space-4;

  @media (max-width: $mobile-breakpoint) {
    padding: $space-3;
  }
}

// Help content typography
.help-content {
  font-family: $font-inter;
  font-size: $font-sm;
  line-height: $leading-relaxed;
  color: $neutral-dark-gray;

  h2 {
    font-family: $font-cal-sans;
    font-size: $font-h5;
    color: $neutral-black;
    margin: 0 0 $space-4;

    // Gradient accent bar with border
    background: linear-gradient(
      to left,
      $primary-lightest 0%,
      $primary-light 20%,
      transparent 70%
    );
    padding: $space-4 $space-5;
    border: 1px solid $primary-light;
    border-radius: $radius-lg;

    @media (max-width: $mobile-breakpoint) {
      font-size: $font-h6;
      margin: 0 0 $space-3;
      padding: $space-3 $space-4;
    }
  }

  h3 {
    font-family: $font-cal-sans;
    font-size: $font-base;
    color: $neutral-black;
    margin: $space-6 0 $space-3;

    &:first-child {
      margin-top: 0;
    }

    @media (max-width: $mobile-breakpoint) {
      margin: $space-4 0 $space-2;
    }
  }

  h4 {
    font-family: $font-cal-sans;
    font-size: $font-sm;
    color: $neutral-dark-gray;
    margin: $space-4 0 $space-2;

    @media (max-width: $mobile-breakpoint) {
      margin: $space-3 0 $space-1;
    }
  }

  p {
    font-size: $font-sm;
    margin: 0 0 $space-3;

    @media (max-width: $mobile-breakpoint) {
      margin: 0 0 $space-2;
    }
  }

  ul, ol {
    margin: 0 0 $space-3;
    padding-left: $space-6;
    list-style-position: outside;

    @media (max-width: $mobile-breakpoint) {
      padding-left: $space-6;
      margin: 0 0 $space-2;
    }
  }

  ul {
    list-style-type: disc;
  }

  ol {
    list-style-type: decimal;
  }

  li {
    font-size: $font-sm;
    margin-bottom: $space-1;
    display: list-item;
  }

  strong {
    font-weight: $font-semibold;
    color: $neutral-black;
  }

  code {
    font-family: monospace;
    font-size: $font-xs;
    background: $neutral-light-gray;
    padding: $space-half $space-1;
    border-radius: $radius-sm;
    word-break: break-word;
  }

  // Tables - wrapped for mobile scrolling
  .table-wrapper {
    width: 100%;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    margin: $space-4 0;
  }

  table {
    width: 100%;
    border-collapse: collapse;
    margin: $space-4 0;
    font-size: $font-xs;
    min-width: 300px; // Prevent tables from becoming too narrow
  }

  th, td {
    padding: $space-2 $space-3;
    text-align: left;
    border: $border-full solid $neutral-gray;
    white-space: nowrap;

    @media (max-width: $mobile-breakpoint) {
      white-space: normal;
      padding: $space-2;
      font-size: $font-xs;
    }
  }

  th {
    background: $neutral-light-gray;
    font-weight: $font-semibold;
    color: $neutral-black;
  }

  td {
    background: $neutral-white;
  }

  // Mobile-specific table adjustments
  @media (max-width: $mobile-breakpoint) {
    table {
      font-size: $font-xs;
    }

    // Allow horizontal scroll for tables that overflow
    .help-section__content-inner,
    & {
      overflow-x: auto;
    }
  }

  // Status indicators - match actual credit status colors from CardCreditsTypes.ts
  .status-indicator {
    display: inline-flex;
    align-items: center;
    gap: $space-1;

    &::before {
      content: '';
      width: 10px;
      height: 10px;
      border-radius: $radius-full;
    }

    // Credit status colors (matching CREDIT_USAGE_DISPLAY_COLORS)
    &--used::before {
      background: $primary-medium; // #007B53 - USED
    }

    &--partially-used::before {
      background: $accent-medium; // #005DCF - PARTIALLY_USED
    }

    &--not-used::before {
      background: $neutral-black; // #0B0D0F - NOT_USED
    }

    &--inactive::before {
      background: $neutral-medium-gray; // #B5BBC2 - INACTIVE
    }

    &--disabled::before {
      background: $disabled-gray; // #9CA3AF - DISABLED
    }

    &--future::before {
      background: $neutral-medium-gray; // Future periods
    }
  }

  // Navigation path styling
  .nav-path {
    font-weight: $font-medium;
    color: $primary-medium;
  }

  // Callout boxes
  .callout {
    padding: $space-3 $space-4;
    border-radius: $radius-lg;
    margin: $space-4 0;

    @media (max-width: $mobile-breakpoint) {
      padding: $space-2 $space-3;
      margin: $space-3 0;
    }

    &--info {
      background: color.adjust($accent-color, $lightness: 45%);
      border-left: 3px solid $accent-color;
    }

    &--tip {
      background: $primary-lightest;
      border-left: 3px solid $primary-color;
    }

    &--warning {
      background: color.adjust($warning, $lightness: 40%);
      border-left: 3px solid $warning;
    }
  }

  // Icon inline styling
  .icon-inline {
    display: inline-flex;
    align-items: center;
    gap: $space-1;
    vertical-align: middle;
  }
}

// Glossary specific styles
.glossary {
  &__term {
    font-weight: $font-semibold;
    color: $neutral-black;
  }

  &__definition {
    margin-left: $space-4;
    margin-bottom: $space-3;
    padding-left: $space-3;
    border-left: 2px solid $neutral-gray;
  }

  &__group {
    margin-bottom: $space-6;

    h3 {
      font-size: $font-h6;
      color: $primary-medium;
      border-bottom: $border-full solid $neutral-gray;
      padding-bottom: $space-2;
      margin-bottom: $space-1;
    }
  }

  &__group-description {
    font-size: $font-xs;
    color: $neutral-medium-gray;
    margin-bottom: $space-3;
    font-style: italic;
  }

  // Keep legacy class for backwards compatibility
  &__letter-group {
    margin-bottom: $space-6;

    h3 {
      font-size: $font-h6;
      color: $primary-medium;
      border-bottom: $border-full solid $neutral-gray;
      padding-bottom: $space-2;
      margin-bottom: $space-3;
    }
  }
}

// FAQ specific styles
.faq {
  &__category {
    margin-bottom: $space-6;
  }

  &__category-title {
    font-size: $font-base;
    color: $neutral-black;
    margin-bottom: $space-3;
    padding-bottom: $space-2;
    border-bottom: $border-full solid $neutral-gray;
  }
}
