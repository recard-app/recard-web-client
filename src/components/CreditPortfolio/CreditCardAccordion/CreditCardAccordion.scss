@use '../../../styling/variables' as *;
@use '../../../styling/mixins' as *;

.credit-card-accordion {
  @include interactive-card;
  overflow: hidden;

  &.expanded {
    border-color: $neutral-gray;
  }

  // Accordion header - clickable button
  // Must reset global button styles since this is a <button> element
  .accordion-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    width: 100%;
    padding: $space-4;
    background: transparent;
    background-color: transparent;
    border: none;
    border-radius: 0;
    cursor: pointer;
    text-align: left;
    position: relative;
    color: inherit;
    font-weight: inherit;

    // Override global button hover/active states
    &:hover,
    &:active,
    &:hover:not(:disabled),
    &:active:not(:disabled) {
      background: transparent;
      background-color: transparent;
      transform: none;
    }

    // Focus state for keyboard navigation
    &:focus-visible {
      outline: 2px solid $primary-color;
      outline-offset: -2px;
      box-shadow: none;
    }
  }

  // Card identity section
  .card-identity {
    display: flex;
    align-items: center;
    gap: $space-3;
    flex: 1;
    min-width: 0;

    .card-icon {
      flex-shrink: 0;
    }

    .card-info {
      display: flex;
      flex-direction: column;
      gap: 2px;
      min-width: 0;

      .card-name {
        font-family: $font-manrope;
        font-size: $font-sm;
        font-weight: $font-semibold;
        color: $neutral-black;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;

        .preferred-star-icon {
          display: inline;
          margin-right: 2px;
          margin-top: 1px;
          vertical-align: text-top;
        }

        .frozen-icon {
          display: inline-flex;
          flex-shrink: 0;
          margin-right: 4px;
          vertical-align: middle;
        }
      }

      .card-meta {
        font-family: $font-manrope;
        font-size: $font-xs;
        color: $neutral-dark-gray;
      }
    }
  }

  // Header stats section
  .header-stats {
    display: flex;
    align-items: center;
    gap: $space-4;
    flex-shrink: 0;

    .usage-stat {
      display: flex;
      flex-direction: column;
      align-items: flex-end;
      gap: 2px;

      .usage-value {
        font-family: $font-manrope;
        font-size: $font-sm;
        font-weight: $font-semibold;
        color: $neutral-black;
      }

      .usage-label {
        font-family: $font-manrope;
        font-size: $font-xs;
        color: $neutral-dark-gray;
      }
    }

    .usage-percentage {
      .percentage-value {
        font-family: $font-manrope;
        font-size: $font-sm;
        font-weight: $font-bold;
        padding: $space-1 $space-2;
        border-radius: $radius-sm;

        &.high {
          color: $success;
          background-color: rgba($success, 0.1);
        }

        &.medium {
          color: $warning;
          background-color: rgba($warning, 0.1);
        }

        &.low {
          color: $neutral-dark-gray;
          background-color: $neutral-lightest-gray;
        }
      }
    }

    .chevron-icon {
      transition: transform 0.2s ease;

      &.rotated {
        transform: rotate(180deg);
      }
    }
  }

  // Accordion content
  .accordion-content {
    border-top: $border-full solid $neutral-light-gray;
    padding: 0 $space-4 $space-4;
  }

  // Responsive
  @media (max-width: $mobile-breakpoint) {
    .accordion-header {
      padding: $space-3;
      padding-right: $space-8; // Make room for absolute chevron
      flex-wrap: wrap;
      gap: $space-2;
    }

    .card-identity {
      flex: 1 1 100%;
    }

    .header-stats {
      flex: 1 1 100%;
      justify-content: space-between;

      .usage-stat {
        flex-direction: row;
        align-items: baseline;
        gap: $space-1;
      }

      .chevron-icon {
        position: absolute;
        top: $space-3;
        right: $space-3;
      }
    }

    .accordion-content {
      padding: 0 $space-3 $space-3;
    }
  }
}
